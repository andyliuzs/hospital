<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>科室列表</title>
	
	<link rel="stylesheet" type="text/css" href="../static/css/data.css" />
	<script type="text/javascript"
		src="../static/assets/jquery/jquery-1.10.2.min.js"></script>
	<script type="text/javascript" src="../static/js/common.js"></script>
	
	<script type="text/javascript">
		function del(url){
			if(confirm('您确定要删除本科室信息？科室删除后，该科室下的所有医生信息都将被删除，请谨慎操作！！！')) {
				
				$.get(url, function(data) {
					alert(data.msg);
					location.reload();
				});
			}
		 }
		
		//页面加载之后,设置.样式.  
		$(function(){  
		    
		    $(".data-box table td p.desc").each(function(i){  
		         if($(this).text().length > 150){  
		    		$(this).attr("title", $(this).text()); 
		    		var text = $(this).text().substring(0, 150) + "...";  
	                $(this).text(text);  
		         }  
	        });  
		});  
	
	</script>
	
</head>
<body>

	<div class="search-box">
		<form name="searchForm" action="/admin/department/search" method="post">
			<span>科室名称：
				<input type="text" name="name" id="name" value="${searchName!}" />&nbsp;
				<select name="directorId">
					<option value="-1">请选择科室主任</option> 
					<#list doctors as doctor> 
						<#if doctor.id == searchDirectorId>
							<option value="${doctor.id}" selected="selected">${doctor.name}</option>
						<#else>
							<option value="${doctor.id}">${doctor.name}</option> 
						</#if> 
					</#list>
				</select>
				<select name="key">
					<option value="-1" >科室级别</option>
					<option value="1" <#if searchKey == 1 >selected="selected"</#if> >重点科室</option>
					<option value="0" <#if searchKey == 0 >selected="selected"</#if> >普通科室</option>
				</select>
				<input type="submit" name="subButton" id="subButton" value="查询" />		
			</span>
		</form>
	</div>
	
	<div class="data-box">
		<table class="gridtable">
			<thead align="center">
				<tr>
					<th width="100">科室图片</th>
					<th width="80">科室名称</th>
					<th width="80">科室级别</th>
					<th>科室描述</th>
					<th width="80">科室主任</th>
					<th width="80">排序值</th>
					<th width="120">操作</th>
				</tr>
			</thead>
			<tbody>
				<#list departmentList.list as department>
					<tr>
						<td align="center"><img src="${(department.image)!}" onload="resizeImage(this, 70, 70);" /></td>
						<td align="center">${department.name}</td>
						<td align="center"><#if department.recommend == 1>重点<#else>普通</#if></td> 
						<td><p class="desc">${department.desc}</p></td> 
						<td align="center">${(department.getDirector().name)!}</td>
						<td align="center">${department.sort}</td>
						<td align="center">
							<a href="/admin/department/edit/${department.id}">编辑</a>
							&nbsp;&nbsp;
							<a href="javascript:void(0)" onclick="del('/admin/department/delete/${department.id}')">删除</a>
						</td>
					</tr>
				</#list>
			</tbody>
		</table>
	</div>

	<div class="page-box">
		<span style="margin-left: 10px"> 
		共${departmentList.totalRow}条记录&nbsp;共${departmentList.totalPage}页  每页${departmentList.pageSize}条数据  当前第${departmentList.pageNumber}页     
		<a href="/admin/department/?p=1<#if searchPage == 1>&s=1</#if>" >[首页]</a>
		<a href="/admin/department/?p=<#if departmentList.pageNumber lte 1>1<#else>${departmentList.pageNumber - 1}</#if><#if searchPage == 1>&s=1</#if>" >[上一页]</a> 
		<a href="/admin/department/?p=<#if departmentList.pageNumber gte departmentList.totalPage>${departmentList.totalPage}<#else>${departmentList.pageNumber + 1}</#if><#if searchPage == 1>&s=1</#if>" >[下一页]</a> 
		<a href="/admin/department/?p=${departmentList.totalPage}<#if searchPage == 1>&s=1</#if>" >[末页]</a>
		 
		</span>
	</div>

</body>
</html>